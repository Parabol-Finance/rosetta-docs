---
title: "Smart Allocation Logic"
description: ""
sidebarTitle: "Smart Allocation Logic"
---

## Routing Logic

The Routing Logic determines how capital is allocated across vaults. It answers: given the user's policies and current market conditions, where should funds be?

### Decision Inputs

The Router evaluates:

| Input | Source |
| --- | --- |
| Current APY per vault | Indexer (block-level) |
| Post-deposit APY | Indexer (impact simulation) |
| Available liquidity | Indexer |
| User's enabled vaults | Policies |
| Current allocation | Smart account state |

### Signal Generation

Based on these inputs, the Router generates allocation signals:

- **Deposit signal**: Which vault should receive new deposits
- **Rebalance signal**: Whether current allocation should shift to a different vault
- **Hold signal**: Current allocation remains optimal

Signals are generated only when improvement exceeds minimum thresholds. The Router does not rebalance for marginal gains.

### Execution

When a signal is generated:

1. Router validates action against user's policies
2. Transaction is submitted to user's smart account
3. Smart account executes on-chain
4. Rosetta sponsors gas costs
